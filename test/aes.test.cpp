/* Example taken from http://www.kavaliro.com/wp-content/uploads/2014/03/AES.pdf
 */
#include "aes/aes.h"
#include <catch.hpp>

using aes::matrix;

TEST_CASE( "AES full algorithm", "[aes]" ) {
    matrix data{
        0x54, 0x4F, 0x4E, 0x20,
        0x77, 0x6E, 0x69, 0x54,
        0x6F, 0x65, 0x6E, 0x77,
        0x20, 0x20, 0x65, 0x6F,
    };
    matrix key{
        0x54, 0x73, 0x20, 0x67,
        0x68, 0x20, 0x4B, 0x20,
        0x61, 0x6D, 0x75, 0x46,
        0x74, 0x79, 0x6E, 0x75,
    };
    matrix ans{
        0x29, 0x57, 0x40, 0x1A,
        0xC3, 0x14, 0x22, 0x02,
        0x50, 0x20, 0x99, 0xD7,
        0x5F, 0xF6, 0xB3, 0x3A,
    };
    CHECK( aes::aes( data, key ) == ans );
    CHECK( aes::aes_inv( ans, key ) == data );
}
